# Отток клиентов банка

## Цель проекта
Пользуясь историческими данными о поведении клиентов и расторжении договоров с банком необходимо прогнозировать, уйдёт клиент из банка в ближайшее время или нет

## Навыки и инструменты


* Python;
* Pandas;
* Matplotlib;
* Seaborn;
* SciPy;
* Sklearn;
* Optuna;
* проверка статистических гипотез;
* описательная статистика;
* Машинное обучение.

## Описание проекта.

Изучались модели для прогнозирования ухода клиентов из банка. Использовались следующие модели:
* на основе решающего дерева;
* на основе случайного леса;
* на основе логистической регрессии.

Целевой признак -- значения столбца exited.

В исходной выборке признаки gender и geography кодировались с помощью метода прямого кодирования. Далее выборка разбивалась на три в соотношении 3:1:1. 

Количественные признаки (balance, estimated_salary, credit_score) масштабировались с помощью функции scaler.  

Модели проверялись как на несбалансированной выборке, так и на сблансированной. Для баланса классов применялись следующие методы:

* взвешивание классов;
* уменьшение выборки;
* увеличение выборки.

Получены следующие результаты:

|Модель| F1 |
|-----------|------------|
|Несбалансированная выборка||
|Решающее дерево| 0.58|
|Случайный лес| 0.57|
|Логистическая регрессия| 0.36|
|Взвешенные классы||
|Решающее дерево| 0.60|
|Случайный лес| 0.62|
|Логистическая регрессия| 0.35|
|Уменьшенная выборка||
|Решающее дерево| 0.58|
|Случайный лес| 0.57|
|Логистическая регрессия| 0.36|
|Увеличенная выборка:||
|Решающее дерево| 0.58|
|Случайный лес| 0.58|
|Логистическая регрессия| 0.36|

Наилучшее значение F1-метрики имеет модель на основе случайного леса полученная на выборке со взвешиванием классов. Эта модель проверялась на тестовой выборке. 

Значение F1 на тестовой выборке составило 0.62, значение метрики AUC-ROC = 0.86. Модель адекватна: ее предсказания отличаются от предсказаний случайной и 
константной моделей, она выдает только требуемые значения.
